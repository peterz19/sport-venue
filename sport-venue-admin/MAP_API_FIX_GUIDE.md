# 高德地图API修复指南

## 问题描述

当前高德地图API返回 `USERKEY_PLAT_NOMATCH` 错误，导致地理编码和逆地理编码功能无法正常工作。

## 错误分析

错误码 `10009` 表示 "USERKEY_PLAT_NOMATCH"，原因如下：

1. **域名白名单未配置** - API密钥没有配置正确的域名白名单
2. **安全密钥配置错误** - 安全密钥可能没有正确配置
3. **平台类型不匹配** - API密钥可能配置了错误的平台类型

## 解决方案

### 1. 登录高德地图开放平台

访问 [高德地图开放平台](https://lbs.amap.com/) 并登录您的账户。

### 2. 检查API密钥配置

1. 进入 **控制台** → **应用管理**
2. 找到您的应用（API密钥：`d16c4f8b60ffec2c8af025b192686cc5`）
3. 点击 **编辑** 按钮

### 3. 配置域名白名单

在应用配置页面中：

1. **Web服务API** 部分：
   - 添加 `localhost` 到域名白名单
   - 添加您的实际域名（如果有的话）
   - 添加 `127.0.0.1`

2. **JavaScript API** 部分：
   - 添加 `localhost` 到域名白名单
   - 添加您的实际域名（如果有的话）
   - 添加 `127.0.0.1`

### 4. 检查安全密钥

1. 确认安全密钥 `ddaa63cdcc534f87953433fa1557f4de` 是否正确
2. 如果安全密钥不正确，请重新生成

### 5. 检查平台类型

确保API密钥配置了正确的平台类型：
- **Web服务API** - 用于服务器端调用
- **JavaScript API** - 用于浏览器端调用

## 测试步骤

1. 配置完成后，等待5-10分钟让配置生效
2. 刷新测试页面
3. 点击 **测试API密钥** 按钮
4. 如果返回成功，再测试地理编码和逆地理编码功能

## 常见问题

### Q: 为什么定位功能可以工作，但地理编码不行？

A: 定位功能使用的是浏览器的原生API，不依赖高德地图的Web服务API，所以不受API密钥限制影响。

### Q: 配置域名白名单后多久生效？

A: 通常5-10分钟内生效，如果超过30分钟仍未生效，请检查配置是否正确。

### Q: 本地开发环境如何处理？

A: 在域名白名单中添加 `localhost` 和 `127.0.0.1` 即可。

## 备用方案

如果问题仍然存在，可以考虑：

1. **创建新的API密钥** - 重新创建一个新的应用和API密钥
2. **使用其他地图服务** - 如百度地图、腾讯地图等
3. **本地化处理** - 将地理编码功能移到后端处理

## 联系支持

如果按照以上步骤仍然无法解决问题，请联系高德地图技术支持或项目维护者。 